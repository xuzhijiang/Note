# 为什么InnoDB表必须有主键,并且推荐使用整型的自增主键?

如果你没有给InnoDB的表建立主键,mysql底层会自动挑选一个能够唯一标识数据的字段作为主键索引,如果找不到,她会给你生成一个隐藏列,这个隐藏列可以唯一标识每行数据.然后innodb根据这个隐藏列来建立主键索引.从而使用b+tree来组织数据.

    因为innodb就是使用b+tree来组织索引和数据的,如果表没有建立主键,就没法通过b+树来组织数据

    这也就要求使用InnoDB的话,必须要创建主键.

工作中的主键不要使用uuid,而是要使用整型,因为整型的比较效率更高(通过索引查找的时候会涉及比较),而且占用的空间也比较小.这就是为什么要使用整型.

如果主键使用uuid的话,因为每个uuid都不是递增的,是随机的,当新增数据的时候,uuid是随机的,那么这条数据插入的位置也就是随机的,会造成b+tree的大量的树的平衡和分裂.(花费时间和性能)

    分裂就是树的分叉.

    如果是递增的整型的话,每次新添加的元素都是有序的在叶子节点往后添加,不会造成大量的树的平衡和分裂.这就是为什么要使用 "自增的"整型.

![](../pics/b+分裂理解01.png)

![](../pics/b+分裂理解02.png)

![](../pics/b+分裂理解03.png)